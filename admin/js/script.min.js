!function(a){a(document).ready(function(){function i(i){var t=i;return 0==t?(a("#aqua-admin-image-btn").attr("btn-type","create").text("Adicionar Imagem"),l={url:"",link:""}):(a("#aqua-admin-image-btn").attr("btn-type","update").text("Atualizar Imagem"),l={url:a(t).find(".aqua-image-display img").attr("src"),link:a(t).find(".aqua-image-display img").attr("aqua-img-link")}),l}function t(){return r=a("#aqua-images-content .aqua-box-image").length,a("#no_img_alert").css(0==r?{display:"block",opacity:1}:{display:"none",opacity:0}),r}function e(i){var t=i,e=a("#aqua-admin-alert");e.css({display:"block"}).find("p span").text(t);var n=a("html, body");n.stop().animate({scrollTop:0},200),e.animate({opacity:1},1e3,function(){setTimeout(function(){e.animate({opacity:0},1e3,function(){e.css({display:"none"})})},1e3)})}var n=Number(a("#aqua-params-admin").height());a("#aqua-admin-body").css({height:n+100}),a.ajax({url:ajaxurl,method:"GET",data:{action:"get_all_images"}}).done(function(i){var e=JSON.parse(i);if("undefined"==typeof e.msg){var n,l,s=e.length;for(n=1;s>=n;n++){l=n-1;var u={url:e[l].url,link:e[l].link,pos:e[l].position},r="<div class='aqua-box-image' aqua-box-position='"+u.pos+"'><div class='aqua-image-display'><div class='aqua-overlay'></div><img link-url='"+u.link+"' src='"+u.url+"' /></div><div class='aqua-data-display'><div class='btn-data-position'><span><i class='fa fa-picture-o'></i> <label>"+u.pos+"</label></span><span title='Editar' class='aqua-btn-img aqua-img-edit'><i class='fa fa-pencil'></i></span><span title='Remover' class='aqua-btn-img aqua-img-del'><i class='fa fa-trash-o'></i></span></div><div class='img-drop-icon'></div></div></div>";a("#aqua-images-content").append(r)}}t()}),a.ajax({url:ajaxurl,method:"GET",data:{action:"get_all_params"}}).done(function(i){var t=JSON.parse(i);"Existe!"==t.msg&&(a("input[name='aqua-slider-width']").val(t.params.width),a("input[name='aqua-slider-height']").val(t.params.height),a("select[name='aqua-slider-bullet']").val(t.params.bullet),a("input[name='aqua-slider-animation']").val(t.params.animation),a("select[name='aqua-slider-control']").val(t.params.control),a("select[name='aqua-slider-autoPlay']").val(t.params.autoPlay),a("select[name='aqua-slider-type']").val(t.params.effect))}),a("#aqua-slider-media-libray").click(function(){return formfield=a("#upload_image").attr("name"),tb_show("","media-upload.php?type=image&TB_iframe=true"),!1}),window.send_to_editor=function(i){a(".tb-close-icon").trigger("click"),a("#img-url").val(""),imgurl=a("img",i).attr("src"),a("#img-url").val(imgurl)},a("#aqua-images-content").sortable({cancel:"#no_img_alert",deactivate:function(){var i=a(this),t=1;i.find(".aqua-box-image").each(function(){var i=a(this);i.attr("aqua-box-position",t),i.find(".aqua-data-display label").text(t),t++})}}),a("#aqua-images-content").on("click",".aqua-box-image .aqua-data-display .aqua-img-del",function(){var i=a(this).parents(".aqua-data-display").parents(".aqua-box-image"),n=confirm("Deseja remover esta imagem?");if(n){var l={url:i.find(".aqua-image-display img").attr("src"),pos:i.find(".aqua-data-display span label").text()};a.ajax({url:ajaxurl,method:"POST",data:{action:"remove_image",img_data:l}}).done(function(a){var n=JSON.parse(a);(n.msg="Imagem deletada!")?i.attr("aqua-box-position","").animate({opacity:0},1e3,function(){i.remove(),e("Imagem removida!"),t()}):console.log(n)})}}),a("#aqua-images-content").on("click",".aqua-box-image .aqua-data-display .aqua-img-edit",function(){var t=a(this).parents(".aqua-data-display").parents(".aqua-box-image");i(t),u.dialog("open")}),a("#aqua-btn-params").on("click",function(i){i.preventDefault();var t={width:a("input[name='aqua-slider-width']").val(),height:a("input[name='aqua-slider-height']").val(),bullet:a("select[name='aqua-slider-bullet']").val(),animation:a("input[name='aqua-slider-animation']").val(),control:a("select[name='aqua-slider-control']").val(),autoPlay:a("select[name='aqua-slider-autoPlay']").val(),effect:a("select[name='aqua-slider-effect']").val()};a.ajax({url:ajaxurl,method:"POST",data:{action:"send_all_params",params:t}}).done(function(){e("Par√¢metros atualizados!")})});var l,s,u=a("#aqua-image-config").dialog({autoOpen:!1,modal:!0,height:300,width:500,closeText:"x",resizable:!1,position:{my:"top",at:"top+150"},open:function(){var i=a("#aqua-image-config");i.find("input[name='aqua-img-url']").val(l.url),i.find("input[name='aqua-img-link']").val(l.link),s=a("input[name='aqua-img-url']").val()}});a("#aqua-admin-btn-new-img").on("click",function(){i(0),u.dialog("open")}),a("#aqua-admin-image-btn").on("click",function(i){i.preventDefault();var e=a(this),n={url:a("#aqua-image-config").find("#img-url").val(),link:a("#aqua-image-config").find("input[name='aqua-img-link']").val(),type:e.attr("btn-type")};if(""==n.url)return!1;if("create"==n.type){var l=Number(a(".aqua-box-image").length)+1,u="<div class='aqua-box-image' aqua-box-position='"+l+"'><div class='aqua-image-display'><div class='aqua-overlay'></div><img link-url='"+n.link+"' src='"+n.url+"' /></div><div class='aqua-data-display'><span><i class='fa fa-picture-o'></i> <label>"+l+"</label></span><span title='Editar' class='aqua-btn-img aqua-img-edit'><i class='fa fa-pencil'></i></span><span title='Remover' class='aqua-btn-img aqua-img-del'><i class='fa fa-trash-o'></i></span><div class='img-drop-icon'></div></div></div>";a("#aqua-images-content").append(u),a(".ui-dialog-titlebar-close").trigger("click")}else if("update"==n.type){var r;a("#aqua-images-content").find(".aqua-box-image").each(function(){var i=a(this);i.find(".aqua-image-display img").attr("src")==s&&(r=i.find(".aqua-image-display img"))}),a(".ui-dialog-titlebar-close").trigger("click"),r.animate({opacity:0},1e3,function(){r.attr("src",n.url).attr("link-url",n.link).animate({opacity:1},1e3)})}t()});var r;a("#aqua-admin-btn-save-img").on("click",function(){if(t(),1>r)return!1;var i={data:[]};a("#aqua-images-content").find(".aqua-box-image").each(function(){var t=a(this),e=t.find(".aqua-image-display img").attr("src"),n=t.find(".aqua-image-display img").attr("link-url"),l=t.find(".aqua-data-display span label").text();return""==l?!0:void i.data.push({url:e,link:n,pos:l})}),a.ajax({url:ajaxurl,method:"POST",data:{action:"save_all_images",data_img:i}}).done(function(a){var i=JSON.parse(a);e("Imagens alteradas!"==i.msg?"Imagens atualizadas!":"Houve algum erro!")})})})}(jQuery);